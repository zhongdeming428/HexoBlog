<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>从源码看 Vue 中的 Mixin | D.M</title>
  <meta name="description" content>
  <meta name="keywords" content="ZhongDeming,zhongdeming428,Blog,Front-End,JavaScript">
  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="shortcut icon" href="/images/logo.png">
  <link rel="alternate" href="/atom.xml" title="D.M">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="最近在做项目的时候碰到了一个奇怪的问题，通过 Vue.mixin 方法注入到 Vue 实例的一个方法不起作用了，后来经过仔细排查发现这个实例自己实现了一个同名方法，导致了 Vue.mixin 注入方法的失效。后来查阅资料发现 Vue.mixin 注入到实例的 methods 方法会被实例中的同名方法替换，而不会依次执行。于是我就有了查看源码的想法，进而诞生了这篇文章～  本文所用源码版本为  2.">
<meta name="keywords" content="ZhongDeming,zhongdeming428,Blog,Front-End,JavaScript">
<meta property="og:type" content="article">
<meta property="og:title" content="从源码看 Vue 中的 Mixin">
<meta property="og:url" content="http://zhongdeming.fun/2019/05/19/从源码看Vue中的Mixin/index.html">
<meta property="og:site_name" content="D.M">
<meta property="og:description" content="最近在做项目的时候碰到了一个奇怪的问题，通过 Vue.mixin 方法注入到 Vue 实例的一个方法不起作用了，后来经过仔细排查发现这个实例自己实现了一个同名方法，导致了 Vue.mixin 注入方法的失效。后来查阅资料发现 Vue.mixin 注入到实例的 methods 方法会被实例中的同名方法替换，而不会依次执行。于是我就有了查看源码的想法，进而诞生了这篇文章～  本文所用源码版本为  2.">
<meta property="og:locale" content="Chinese">
<meta property="og:image" content="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code1.png">
<meta property="og:image" content="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code2.png">
<meta property="og:image" content="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code3.png">
<meta property="og:image" content="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code4.png">
<meta property="og:image" content="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code5.png">
<meta property="og:image" content="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code6.png">
<meta property="og:image" content="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code7.png">
<meta property="og:image" content="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code8.png">
<meta property="og:image" content="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code9.png">
<meta property="og:image" content="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code10.png">
<meta property="og:updated_time" content="2021-05-07T21:21:43.640Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="从源码看 Vue 中的 Mixin">
<meta name="twitter:description" content="最近在做项目的时候碰到了一个奇怪的问题，通过 Vue.mixin 方法注入到 Vue 实例的一个方法不起作用了，后来经过仔细排查发现这个实例自己实现了一个同名方法，导致了 Vue.mixin 注入方法的失效。后来查阅资料发现 Vue.mixin 注入到实例的 methods 方法会被实例中的同名方法替换，而不会依次执行。于是我就有了查看源码的想法，进而诞生了这篇文章～  本文所用源码版本为  2.">
<meta name="twitter:image" content="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code1.png">
    
  <link href="https://fonts.googleapis.com/css?family=Inconsolata|Titillium+Web" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
  <link href="//cdn.bootcss.com/node-waves/0.7.5/waves.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
  <style>
    *{margin:0;padding:0;}
    img{border:0 none;}
    body{background:#eee;}
    .m-box{margin:0 auto;display:inline-block;padding:20px;background:#fff;}
    .m-box p{margin:0 0 10px;}
    .m-box .icn a{display:block;width:55px;height:35px;background:url('http://l.bst.126.net/rsc/img/weibo.png?035') no-repeat;}
    .m-box .icn .wb1{background-position:10px -216px;}
    .m-box .icn .wb2{background-position:-190px -216px;}
    .m-box .icn .wb3{background:url(http://l.bst.126.net/rsc/img/postshare/tieba24.png) 15px 0 no-repeat;}
    .m-box .icn .wb4{background-position:-88px -215px;}
    .m-box .icn .wb5{background-position:-138px -216px;}
    .m-box .icn .wb6{background-position:-245px -216px;}
    .m-box .icn .wb7{background-position:-300px -216px;}
    .m-box .icn .wb8{background-position:-355px -216px;}
    .m-box .icn .wb9{background-position:-415px -215px;}
  </style>
  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
</head>
</html>
<body>
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>


  <script>setLoadingBarProgress(20)</script> 
  <header class="l_header">
	<div class='wrapper'>
		<div class="nav-main container container--flex">
			<a class="logo flat-box" href='/' >
				D.M
			</a>
			<div class='menu'>
				<ul class='h-list'>
					
						<li>
							<a class='flat-box nav-home' href='/'>
								Home
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-archives' href='/archives'>
								Archives
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-comments' href='/comments'>
								Comments
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-about' href='/about'>
								About
							</a>
						</li>
					
				</ul>
				<div class='underline'></div>
			</div>
			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="Search" />
						<span class="icon icon-search"></span>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a href='javascript:void(0)'><span class="icon icon-search flat-box"></span></a></li>
				
				<li class='s-menu'><a href='javascript:void(0)'><span class="icon icon-menu flat-box"></span></a></li>
			</ul>
		</div>
		
		<div class='nav-sub container container--flex'>
			<a class="logo" class="flat-box" href='javascript:void(0)'>
				Word of Forks
			</a>

			<ul class='switcher h-list'>
				<li class='s-comment'><a href='javascript:void(0)'><span class="icon icon-chat_bubble_outline flat-box"></span></a></li>
				<li class='s-top'><a href='javascript:void(0)'><span class="icon icon-arrow_upward flat-box"></span></a></li>
				<li class='s-toc'><a href='javascript:void(0)'><span class="icon icon-format_list_numbered flat-box"></span></a></li>
			</ul>
		</div>
	</div>
</header>
<aside class="menu-phone">
	<nav>
		
			<a href="/" class="nav-home nav">
				Home
			</a>
		
			<a href="/archives" class="nav-archives nav">
				Archives
			</a>
		
			<a href="/comments" class="nav-comments nav">
				Comments
			</a>
		
			<a href="/about" class="nav-about nav">
				About
			</a>
		
	</nav>
</aside>

    <script>setLoadingBarProgress(40);</script>
  <div class="l_body">
    <div class='container clearfix'>
      <div class='l_main'>
        <article id="post-从源码看Vue中的Mixin"
  class="post white-box article-type-post"
  itemscope itemprop="blogPost">
	<section class='meta'>
	<h2 class="title">
  	<a href="/2019/05/19/从源码看Vue中的Mixin/">
    	从源码看 Vue 中的 Mixin
    </a>
  </h2>
	<time>
	  May 19, 2019
	</time>
	
    
    <div class='cats'>
        <a href="/categories/Vue/">Vue</a>, <a href="/categories/Vue/JavaScript/">JavaScript</a>
    </div>

	<br>
	<span id="busuanzi_container_page_pv">
		<time>浏览次数：<span id="busuanzi_value_page_pv"></span></time>
 	</span>
	</section>
	
		<section class="toc-wrapper"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#一、el"><span class="toc-number">1.</span> <span class="toc-text">一、el</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二、data"><span class="toc-number">2.</span> <span class="toc-text">二、data</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三、生命周期钩子（Hooks）"><span class="toc-number">3.</span> <span class="toc-text">三、生命周期钩子（Hooks）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四、watch"><span class="toc-number">4.</span> <span class="toc-text">四、watch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#五、props、methods、computed"><span class="toc-number">5.</span> <span class="toc-text">五、props、methods、computed</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#六、一些辅助函数"><span class="toc-number">6.</span> <span class="toc-text">六、一些辅助函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#checkComponents"><span class="toc-number">6.1.</span> <span class="toc-text">checkComponents</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#normalizeProps"><span class="toc-number">6.2.</span> <span class="toc-text">normalizeProps</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#normalizeDirectives"><span class="toc-number">6.3.</span> <span class="toc-text">normalizeDirectives</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#七、自定义合并策略"><span class="toc-number">7.</span> <span class="toc-text">七、自定义合并策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#八、总结"><span class="toc-number">8.</span> <span class="toc-text">八、总结</span></a></li></ol></section>
	
	<section class="article typo">
  	<div class="article-entry" itemprop="articleBody">
    	<p>最近在做项目的时候碰到了一个奇怪的问题，通过 <code>Vue.mixin</code> 方法注入到 Vue 实例的一个方法不起作用了，后来经过仔细排查发现这个实例自己实现了一个同名方法，导致了 <code>Vue.mixin</code> 注入方法的失效。后来查阅资料发现 <code>Vue.mixin</code> 注入到实例的 <code>methods</code> 方法会被实例中的同名方法替换，而不会依次执行。于是我就有了查看源码的想法，进而诞生了这篇文章～</p>
<blockquote>
<p>本文所用源码版本为  2.2.6</p>
</blockquote>
<p>首先从 <code>Vue.mixin</code> 这个方法入手，打开 <code>src</code> 目录不难找到 <code>mixin</code> 所在的文件：<code>src/core/global-api/mixin.js</code>，其内容如下：</p>
<p><img src="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code1.png" alt></p>
<a id="more"></a>
<p>可以看到这只是一层简单的封装，核心内容基本都在 <code>mergeOptions</code> 方法中，所以下面打开这个方法所在的文件：<code>src/core/util/options.js</code>。注意 <code>mergeOptions</code> 方法是通过 <code>src/core/util/index.js</code> 引入导出的，其源码在 <code>options.js</code> 中，直接看 <code>options.js</code> 就好了。</p>
<p>在 <code>options.js</code> 中找到 <code>mergeOptions</code> 方法，内容如下：</p>
<p><img src="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code2.png" alt></p>
<p>其主流程大致如下：</p>
<ol>
<li>如果是非生产环境下，首先调用 <code>checkComponents</code> 检查传入参数的合法性，后面再讲具体实现。</li>
<li>调用 <code>normalizeProps</code> 方法和 <code>normalizeDirectives</code> 方法对这两个属性进行规范化。</li>
<li>检查传入参数是否具有 <code>extends</code> 属性，这个属性表示扩展其它 Vue 实例，具体参考<a href="https://cn.vuejs.org/v2/api/#extends" target="_blank" rel="noopener">官方文档</a>。这里为什么要检查这个属性呢？因为当传入对象具有该属性时，表示所有的 Vue 实例都要扩展它所指定的实例（<code>Vue.mixin</code> 的功能即是如此），那么我们在合并之前，需要先把 <code>extends</code> 进行合并，如果 <code>extends</code> 是一个 Vue 构造函数（也可能是扩展后的 Vue 构造函数），那么合并参数变为其 <code>options</code> 选项了；否则直接合并 <code>extends</code>。</li>
<li>检查完传入参数的 <code>extends</code> 属性之后，我们还要检查其 <code>mixins</code> 属性，这个属性的功能参考<a href="https://cn.vuejs.org/v2/api/#mixins" target="_blank" rel="noopener">官方文档</a>。因为如果传入的 Vue 配置对象仍然指定了 <code>mixins</code> 的话，我们需要递归的进行 merge。</li>
<li>做完以上的工作之后，就可以开始合并单纯的 <code>mixin</code> 参数了。可以看到通过 <code>mergeField</code> 函数进行了合并，先遍历合并的目标对象，进行合并了；随后遍历要合并的对象，只对目标对象上不存在的属性进行合并操作。那么合并的重点就到了 <code>mergeFiled</code> 函数了。</li>
</ol>
<p>继续看 <code>mergeField</code> 函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeField</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> strat = strats[key] || defaultStrat</span><br><span class="line">    options[key] = strat(parent[key], child[key], vm, key)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该函数通过 <code>key</code> 值在 <code>strats</code> 中选取合并的具体函数，这是一种典型的策略模式，所以我们看 <code>strats</code>是如何定义的。</p>
<p><code>options.js</code> 中关于 <code>strats</code> 的定义如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Option overwriting strategies are functions that handle</span></span><br><span class="line"><span class="comment"> * how to merge a parent option value and a child option</span></span><br><span class="line"><span class="comment"> * value into the final value.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> strats = config.optionMergeStrategies</span><br></pre></td></tr></table></figure>
<p>其中 <code>config</code> 对象来自于 <code>src/core/config.js</code>，它定义了 <code>config</code> 的所有类型及初始值，当然初始值都还是一些空数组之类的，所以我们要在 <code>options.js</code> 中看具体的实现。</p>
<p>下面根据 Vue 的配置属性分开讲解不同的合并方式。</p>
<h3 id="一、el"><a href="#一、el" class="headerlink" title="一、el"></a>一、el</h3><p><code>el</code> 的合并方式比较简单，因为它本身</p>
<p>源码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Options with restrictions</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">  strats.el = strats.propsData = <span class="function"><span class="keyword">function</span> (<span class="params">parent, child, vm, key</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!vm) &#123;</span><br><span class="line">      warn(</span><br><span class="line">        <span class="string">`option "<span class="subst">$&#123;key&#125;</span>" can only be used during instance `</span> +</span><br><span class="line">        <span class="string">'creation with the `new` keyword.'</span></span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> defaultStrat(parent, child)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到这里有个条件，只有在开发环境下才会定义 <code>strats.el</code> 方法以及 <code>propsData</code> 方法（<a href="https://cn.vuejs.org/v2/api/#propsData" target="_blank" rel="noopener">propsData</a> 文档），这是因为这两个属性比较特殊，尤其是 <code>propsData</code> 只在开发环境下才使用，方便测试而已。另外一个比较特殊的地方是这两者只能在 <code>new</code> 操作符调用 Vue 构造函数所构造的 Vue 实例中才能存在，所以当 <code>vm</code> 未传递时，会弹出一个警告。</p>
<p>这两个属性的合并方法都是 <code>defaultStrat</code>，其源码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Default strategy.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> defaultStrat = <span class="function"><span class="keyword">function</span> (<span class="params">parentVal: any, childVal: any</span>): <span class="title">any</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> childVal === <span class="literal">undefined</span></span><br><span class="line">    ? parentVal</span><br><span class="line">    : childVal</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看出在 <code>childVal</code> 已定义的时候直接替代 <code>parentVal</code>。</p>
<p>这个方法在后边还会用到。</p>
<h3 id="二、data"><a href="#二、data" class="headerlink" title="二、data"></a>二、data</h3><p><code>data</code>选项的合并是重中之重，因为 <code>data</code> 在子组件中是一个函数，它返回的也是一个特殊的响应式对象。</p>
<p>其源码如下：</p>
<p><img src="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code3.png" alt></p>
<p>这里分了两种情况，一种是传递了 vm 参数，一种是没传递。</p>
<p>当没传递 vm 参数的时候，需要校验 <code>childVal</code> 是否是函数，而 <code>parentVal</code> 不需要校验，因为它必须是函数才能通过之前的 merge 校验，到达现在这一步。确定都是函数之后，就调用这两个函数，再然后对返回的两个 data 对象通过 <code>mergeData</code> 做处理，这里后面再讲。</p>
<p>当传递了 vm 参数的时候，需要用其他方式处理，当是函数的时候，使用返回值做下一步合并；当是其他值的时候，直接使用其值进行下一步合并。</p>
<p>这一步要校验 <code>childVal</code>和 <code>parentVal</code> 是否为函数。正是因为这一步校验了，所以前面所讲的情况就不再需要校验，为什么呢？</p>
<p>我们可以回头看 <code>mergeOptions</code> 的源码，发现其第三个参数 vm 是可选的，在递归的时候它会把 vm 传递给自身，这就导致当我们一开始调用 <code>mergeOptions</code> 的时候传递了 vm，则其后所有递归都会传递 vm；当我们一开始未传递 vm 值的时候，其后所有的递归也不会传递 vm 参数。那么是否有 vm 就取决于我们最开始调用该函数时所传递的参数是否包含 vm 了。</p>
<p>全局查找 <code>mergeOptions</code> 函数的调用，可以看到有两处：</p>
<ol>
<li>第一处位于 <code>src/core/instance/init.js</code>，该文件也定义了 <code>initMixin</code> 方法，用于初始化 Vue 把传递给 Vue 构造函数的配置对象合并到 vm.$options 中。这种情况下会传递 vm，其值为当前正在构造的 Vue 实例。</li>
<li>第二处位于之前一直在讲的 <code>src/core/global-api/mixin.js</code>，这处才是定义的全局 API。</li>
</ol>
<p>简而言之，Vue 构造函数构造 Vue 实例时，会调用 <code>mergeOptions</code> 并且传递 vm 实例作为第三个参数；当我们调用 <code>Vue.mixin</code> 进行全局混淆时是不会传递 vm 的。前者对应第二种情况，后者对应第一种情况。</p>
<p>当我们先构造 Vue 实例的时候，vm 被传递进而执行第二种情况，<code>parentVal</code> 会被校验，所以之后再调用 <code>Vue.mixin</code> 时第一种情况不再需要校验。</p>
<p>当我们先不实例化 Vue 而先调用 <code>Vue.mixin</code> 时，会先执行第一种情况的代码，那么会导致 bug 出现吗？答案肯定是不会，因为此时 <code>parentVal</code> 为 <code>undefined</code>，因为 <code>Vue.mixin</code> 调用时 <code>parentVal</code> 的初始值为 <code>Vue.options</code>，这个对象根本不包含 data 属性。</p>
<p>那么 data 合并的任务主要在 <code>mergeData</code> 函数中了，查看其源码：</p>
<p><img src="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code4.png" alt></p>
<p>可以看到这里遍历了要合并的 data 的所有属性，然后根据不同情况进行合并：</p>
<ol>
<li><strong>当目标 data 对象不包含当前属性时</strong>，调用 <code>set</code> 方法进行合并，后面讲 <code>set</code>。</li>
<li><strong>当目标 data 对象包含当前属性并且当前值为纯对象时</strong>，递归合并当前对象值，这样做是为了防止对象存在新增属性。</li>
</ol>
<p>继续看 <code>set</code> 函数：</p>
<p><img src="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code5.png" alt></p>
<p>可以看到 <code>set</code> 也对 target 分了两种情况进行处理。首先判断了 target 是数组的情况，然后如果 target 包含当前属性，那么就直接赋值。接下来判断了 target 是否是响应式对象，如果是的话就会在开发环境下弹出警告，最好不要让 data 函数返回一个响应式对象，因为会造成性能浪费。如果不是响应式对象也可以直接赋值返回，其他情况下就会进一步转化 target 为响应式对象，并收集依赖。</p>
<p>以上大概就是 data 的合并方式，可以看出来如果实例指定了与 mixins 相同名称的 data 值，那么以实例中的为准，mixin 中执行的 data 会失效，如果都是对象但是 mixin 中新增了属性的话，还是会被添加到实例 data 中去的。</p>
<h3 id="三、生命周期钩子（Hooks）"><a href="#三、生命周期钩子（Hooks）" class="headerlink" title="三、生命周期钩子（Hooks）"></a>三、生命周期钩子（Hooks）</h3><p>Hooks 的合并函数定义为 <code>mergeHook</code> 钩子，其源码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Hooks and props are merged as arrays.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeHook</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  parentVal: ?Array&lt;Function&gt;,</span></span></span><br><span class="line"><span class="function"><span class="params">  childVal: ?Function | ?Array&lt;Function&gt;</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): ?<span class="title">Array</span>&lt;<span class="title">Function</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> childVal</span><br><span class="line">    ? parentVal</span><br><span class="line">      ? parentVal.concat(childVal)</span><br><span class="line">      : <span class="built_in">Array</span>.isArray(childVal)</span><br><span class="line">        ? childVal</span><br><span class="line">        : [childVal]</span><br><span class="line">    : parentVal</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个比较简单，代码注释也写得很清楚了，Vue 实例的生命周期钩子被合并为一个数组。具体有哪些钩子可以被合并被写在 <code>src/core/config.js</code> 中：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * List of lifecycle hooks.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">_lifecycleHooks: [</span><br><span class="line">    <span class="string">'beforeCreate'</span>,</span><br><span class="line">    <span class="string">'created'</span>,</span><br><span class="line">    <span class="string">'beforeMount'</span>,</span><br><span class="line">    <span class="string">'mounted'</span>,</span><br><span class="line">    <span class="string">'beforeUpdate'</span>,</span><br><span class="line">    <span class="string">'updated'</span>,</span><br><span class="line">    <span class="string">'beforeDestroy'</span>,</span><br><span class="line">    <span class="string">'destroyed'</span>,</span><br><span class="line">    <span class="string">'activated'</span>,</span><br><span class="line">    <span class="string">'deactivated'</span></span><br><span class="line">],</span><br></pre></td></tr></table></figure>
<p>合并 assets （components、filters、directives）的方法也比较简单，下面跳过了。</p>
<h3 id="四、watch"><a href="#四、watch" class="headerlink" title="四、watch"></a>四、watch</h3><p>合并 <code>watch</code> 的函数源码如下：</p>
<p><img src="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code6.png" alt></p>
<p>这一段源码也很简单，注释也很明了，跟生命周期的钩子一样，<code>Vue.mixin</code> 会把所有同名的 watch 合并到一个数组中去，在触发的时候依次执行就好了。</p>
<h3 id="五、props、methods、computed"><a href="#五、props、methods、computed" class="headerlink" title="五、props、methods、computed"></a>五、props、methods、computed</h3><p>这三项的合并都使用了相同的策略，源代码如下：</p>
<p><img src="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code7.png" alt></p>
<p>这里的处理也比较简单，可以看出来当多次调用 Vue.mixin 混淆时，同名的 props、methods、computed 会被后来者替代；但是当 Vue 构造函数传递了同名的属性时，会以构造函数所接受的配置对象为准。因为 Vue 实例化时也会调用 mergeOptions 第二个参数即为 Vue 构造函数所接受的配置对象，正如前文所述。</p>
<h3 id="六、一些辅助函数"><a href="#六、一些辅助函数" class="headerlink" title="六、一些辅助函数"></a>六、一些辅助函数</h3><p>前文有讲到几个辅助函数，比如：<code>checkComponents</code>、<code>normalizeProps</code>、<code>normalizeDirectives</code>。这里简单贴一下源码：</p>
<h4 id="checkComponents"><a href="#checkComponents" class="headerlink" title="checkComponents"></a>checkComponents</h4><p><img src="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code8.png" alt></p>
<p>这个函数是为了检查 components 属性是否符合要求的，主要是防止自定义组件使用 HTML 内置标签。</p>
<h4 id="normalizeProps"><a href="#normalizeProps" class="headerlink" title="normalizeProps"></a>normalizeProps</h4><p><img src="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code9.png" alt></p>
<p>这个函数主要是对 props 属性进行整理。包括把字符串数组形式的 props 转换为对象形式，对所有形式的 props 进行格式化整理。</p>
<h4 id="normalizeDirectives"><a href="#normalizeDirectives" class="headerlink" title="normalizeDirectives"></a>normalizeDirectives</h4><p><img src="https://www.cnblogs.com/images/cnblogs_com/DM428/1358673/o_code10.png" alt></p>
<p>这个函数也主要是对 directives 属性进行格式化整理的，把原来的对象整理成一个新的符合标准格式的对象。</p>
<h3 id="七、自定义合并策略"><a href="#七、自定义合并策略" class="headerlink" title="七、自定义合并策略"></a>七、自定义合并策略</h3><p>看到 Vue 的官方文档：<a href="https://cn.vuejs.org/v2/guide/mixins.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E9%80%89%E9%A1%B9%E5%90%88%E5%B9%B6%E7%AD%96%E7%95%A5" target="_blank" rel="noopener">自定义选项合并策略</a>，它允许我们自定义合并策略，具体方式就是替换 <code>Vue.config.optionsMergeStrategies</code>，也就是前文所提到的那个定义在 <code>src/core/config.js</code> 中的属性。我们也可以看一下源代码，这一功能在 <code>src/core/global-api/index.js</code> 文件中的 <code>initGlobalAPI</code> 定义。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> configDef = &#123;&#125;</span><br><span class="line">configDef.get = <span class="function"><span class="params">()</span> =&gt;</span> config</span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">    configDef.set = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        warn(</span><br><span class="line">            <span class="string">'Do not replace the Vue.config object, set individual fields instead.'</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(Vue, <span class="string">'config'</span>, configDef)</span><br></pre></td></tr></table></figure>
<p>可以看到最后一句给 Vue 函数定义了一个 <code>config</code> 属性，其 property 定义为 <code>configDef</code>。在生产环境下不允许设置其值，但是在开发环境下，我们可以直接设置 <code>Vue.config</code>。那么通过设置 <code>Vue.config.optionsMergeStrategies</code>，我们可以改变合并策略，在后面再进行合并操作时，都会读取 config 对象中的属性，这时就可以使用我们自定义的合并策略进行合并了。</p>
<h3 id="八、总结"><a href="#八、总结" class="headerlink" title="八、总结"></a>八、总结</h3><p>看了这些属性的合并方式以后，对 <code>Vue.mixin</code> 的工作方式也有了一定的了解了。个人认为基本上可以把 <code>Vue.mixin</code> 合并属性的方式分为三类，一类是替换式、一类是合并式、还有一类是队列式。</p>
<p>替换式的有 <code>el</code>、<code>props</code>、<code>methods</code> 和 <code>computed</code>，这一类的行为是新的参数替代旧的参数。</p>
<p>合并式的有 <code>data</code>，这一类的行为是新传入的参数会被合并到旧的参数中。</p>
<p>队列式合并的有 <code>watch</code>、所有的生命周期钩子（<code>hooks</code>），这一类的行为是所有的参数会被合并到一个数组中，必要时再依次取出。</p>
<p>所以对于 <code>Vue.mixin</code> 的使用我们也需要小心，尤其是替换式合并的属性，当你在 mixins 里面指定了以后，就不要再实例中再指定同名属性了，那样的话你的 mixins 中的属性会被替代导致失效。</p>
<p>作者水平有限，文章难免存在纰漏，敬请大家指正。</p>

  	</div>
	  
		
	
		<div class="art-item-footer">
				
					<span class="art-item-left"><i class="icon icon-chevron-thin-left"></i>prev：<a href="/2019/06/22/从源码学习-node-delegates/" rel="prev"  title="从源码学习 node-delegates">
						从源码学习 node-delegates 
					</a></span>
				
				
					<span class="art-item-right">next：<a href="/2019/05/06/WebPerf101/" rel="next"  title="常见 Web 性能优化方式">
						常见 Web 性能优化方式
					</a><i class="icon icon-chevron-thin-right"></i></span>
				
		</div>
	
	</section>
	
	<div class="m-box">
		<div class="icn"><a  class="wb1" onclick="shareToSinaWB(event)"></a></div>
	</div>
	<div class="m-box">
		<div class="icn"><a class="wb2" onclick="shareToQzone(event)"></a></div>
	</div>
	<div class="m-box">
		<div class="icn"><a class="wb3" onclick="shareToTieba(event)"></a></div>
	</div>
	<div class="m-box">
		<div class="icn"><a class="wb4" onclick="shareToDouban(event)"></a></div>
	</div>
	<div class="m-box">
		<div class="icn"><a class="wb6" onclick="shareToRenren(event)"></a></div>
	</div>
	<div class="m-box">
		<div class="icn"><a class="wb7" onclick="shareToKaixin(event)"></a></div>
	</div>
	<div class="m-box">
		<div class="icn"><a class="wb8" onclick="shareToFacebook(event)"></a></div>
	</div>
	<div class="m-box">
		<div class="icn"><a class="wb9" onclick="shareToTwitter(event)"></a></div>
	</div>
	<div class="comment"></div>
</article>
<script>
	window.subData = {
		title: '从源码看 Vue 中的 Mixin',
		tools: true
	}
</script>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdnjs.loli.net/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!--Valine 的核心代码库-->
<!-- <script src="/js/Valine.min.js"></script> -->
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script>
	new Valine({
		// AV 对象来自上面引入av-min.js(老司机们不要开车➳♡゛扎心了老铁)
		av: AV,
		el: '.comment',
		emoticon_url: 'https://cloud.panjunwen.com/alu',
		emoticon_list: ["吐.png", "期待.png", "高兴.png", "吐血倒地.png", "哭泣.png", "欢呼.png"],
		appId: 'dEN3oH01uVTVRJFwuWKzucX3-gzGzoHsz', // 这里填写上面得到的APP ID
		appKey: 'l11XssvYyHKpzcePOV03e2WJ', // 这里填写上面得到的APP KEY
		placeholder: 'ヾﾉ≧∀≦)o来啊，快活啊!', // 留言框占位提示文字
	});
	var _title,_source,_sourceUrl,_pic,_showcount,_desc,_summary,_site,
			_width = 600,
			_height = 600,
			_top = (screen.height-_height)/2,
			_left = (screen.width-_width)/2,
			_url = window.location.href,
			_pic = 'https://github.com/zhongdeming428/HexoBlog/blob/master/Blogs/source/images/logo.png?raw=true';
	//分享到新浪微博
	function shareToSinaWB(event){
			event.preventDefault();
			var _shareUrl = 'http://v.t.sina.com.cn/share/share.php?&appkey=895033136';     //真实的appkey，必选参数
			_shareUrl += '&url='+ encodeURIComponent(_url||document.location);     //参数url设置分享的内容链接|默认当前页location，可选参数
			_shareUrl += '&title=' + encodeURIComponent(_title||document.title);    //参数title设置分享的标题|默认当前页标题，可选参数
			_shareUrl += '&source=' + encodeURIComponent(_source||'');
			_shareUrl += '&sourceUrl=' + encodeURIComponent(_sourceUrl||'');
			_shareUrl += '&content=' + 'utf-8';   //参数content设置页面编码gb2312|utf-8，可选参数
			_shareUrl += '&pic=' + encodeURIComponent(_pic||'');  //参数pic设置图片链接|默认为空，可选参数
			window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',top='+_top+',left='+_left+',toolbar=no,menubar=no,scrollbars=no, resizable=1,location=no,status=0');
	}
	//分享到QQ空间
	function shareToQzone(event){
			event.preventDefault();
			var _shareUrl = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?';
			_shareUrl += 'url=' + encodeURIComponent(_url||document.location);   //参数url设置分享的内容链接|默认当前页location
			_shareUrl += '&showcount=' + _showcount||0;      //参数showcount是否显示分享总数,显示：'1'，不显示：'0'，默认不显示
			_shareUrl += '&desc=' + encodeURIComponent(_desc||'分享的描述');    //参数desc设置分享的描述，可选参数
			_shareUrl += '&summary=' + encodeURIComponent(_summary||'分享摘要');    //参数summary设置分享摘要，可选参数
			_shareUrl += '&title=' + encodeURIComponent(_title||document.title);    //参数title设置分享标题，可选参数
			_shareUrl += '&site=' + encodeURIComponent(_site||'');   //参数site设置分享来源，可选参数
			_shareUrl += '&pics=' + encodeURIComponent(_pic||'');   //参数pics设置分享图片的路径，多张图片以＂|＂隔开，可选参数
			window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',top='+_top+',left='+_left+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');
	}
	//分享到百度贴吧
	function shareToTieba(event){
			event.preventDefault();
			var _shareUrl = 'http://tieba.baidu.com/f/commit/share/openShareApi?';
			_shareUrl += 'title=' + encodeURIComponent(_title||document.title);  //分享的标题
			_shareUrl += '&url=' + encodeURIComponent(_url||document.location);  //分享的链接
			_shareUrl += '&pic=' + encodeURIComponent(_pic||'');    //分享的图片
			window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',left='+_left+',top='+_top+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');
	}
	//分享到豆瓣
	function shareToDouban(event){
			event.preventDefault();
			var _shareUrl = 'http://shuo.douban.com/!service/share?';
			_shareUrl += 'href=' + encodeURIComponent(_url||location.href);    //分享的链接
			_shareUrl += '&name=' + encodeURIComponent(_title||document.title);    //分享的标题
			_shareUrl += '&image=' + encodeURIComponent(_pic||'');    //分享的图片
			window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',left='+_left+',top='+_top+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');
	}
	//分享到腾讯微博
	function shareToQQwb(event){
			event.preventDefault();
			var _shareUrl = 'http://v.t.qq.com/share/share.php?';
			_shareUrl += 'title=' + encodeURIComponent(_title||document.title);    //分享的标题
			_shareUrl += '&url=' + encodeURIComponent(_url||location.href);    //分享的链接
			_shareUrl += '&appkey=5bd32d6f1dff4725ba40338b233ff155';    //在腾迅微博平台创建应用获取微博AppKey
			_shareUrl += '&site=' + encodeURIComponent(_site||'');   //分享来源
			_shareUrl += '&pic=' + encodeURIComponent(_pic||'');    //分享的图片，如果是多张图片，则定义var _pic='图片url1|图片url2|图片url3....'
			window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',left='+_left+',top='+_top+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');
	}
	//分享到人人网
	function shareToRenren(event){
			event.preventDefault();
			var _shareUrl = 'http://share.renren.com/share/buttonshare.do?';
			_shareUrl += 'link=' + encodeURIComponent(_url||location.href);   //分享的链接
			_shareUrl += '&title=' + encodeURIComponent(_title||document.title);     //分享的标题
			window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',left='+_left+',top='+_top+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');
	}
	//分享到开心网
	function shareToKaixin(event){
			event.preventDefault();
			var _shareUrl = 'http://www.kaixin001.com/rest/records.php?';
			_shareUrl += 'url=' + encodeURIComponent(_url||location.href);    //分享的链接
			_shareUrl += '&content=' + encodeURIComponent('分享的文字');    //需要分享的文字，当文字为空时，自动抓取分享网址的title
			_shareUrl += '&pic=' + encodeURIComponent(_pic||'');     //分享的图片,多个使用半角逗号分隔
			_shareUrl += '&showcount=0';    //是否显示分享数，显示：'1'，不显示：'0'
			_shareUrl += '&style=11';      //显示的样式，必选参数
			_shareUrl += '&aid=' + encodeURIComponent(_site||'');    //显示分享来源
			window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',left='+_left+',top='+_top+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');
	}
	function shareToKaixin2(event){
			event.preventDefault();
			var _shareUrl = 'http://www.kaixin001.com/repaste/share.php?';
			_shareUrl += 'rtitle=' + encodeURIComponent(_title||document.title);   //分享的标题
			window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',left='+_left+',top='+_top+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');
	}
	//分享到facebook
	function shareToFacebook(event){
			event.preventDefault();
			var _shareUrl = 'http://www.facebook.com/sharer/sharer.php?';
			_shareUrl += 'u=' + encodeURIComponent(_url||location.href);    //分享的链接
			_shareUrl += '&t=' + encodeURIComponent(_title||document.title);    //分享的标题
			window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',left='+_left+',top='+_top+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');
	}
	//分享到facebook
	function shareToFacebook(event){
			event.preventDefault();
			var _shareUrl = 'http://www.facebook.com/sharer/sharer.php?';
			_shareUrl += 'u=' + encodeURIComponent(_url||location.href);    //分享的链接
			_shareUrl += '&t=' + encodeURIComponent(_title||document.title);    //分享的标题
			window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',left='+_left+',top='+_top+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');
	}
	//分享到Twitter
	function shareToTwitter(event){
			event.preventDefault();
			var _shareUrl = 'http://twitter.com/intent/tweet?';
			_shareUrl += 'url=' + encodeURIComponent(_url||location.href);    //分享的链接
			_shareUrl += '&text=' + encodeURIComponent(_title||document.title);    //分享的标题
			window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',left='+_left+',top='+_top+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');
	}
</script>
      </div>
      <aside class='l_side'>
        
  <section class='m_widget about'>

<img class='avatar waves-image' src='/images/avatar.jpeg' />

<div class='header'>DM Zhong</div>
<div class='content'>
<div class='desc'>Learn & Live</div>
</div>
</section>

  <section class='m_widget links'>
<div class='header'>Links</div>
<div class='content'>
    <ul class="entry">
    
        <li><a class="flat-box" target="_blank" href="https://juejin.im/user/59424035128fe1006a1c3747">
            <div class='name'>掘金</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://www.cnblogs.com/DM428/">
            <div class='name'>博客园</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://m.weibo.cn/profile/5198069647">
            <div class='name'>新浪微博</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://github.com/zhongdeming428/Blog/issues">
            <div class='name'>原博客地址</div>
        </a></li>
    
    </ul>
</div>
</section>

  <section class='m_widget categories'>
<div class='header'>Categories</div>
<div class='content'>
    
    <ul class="entry">
    
        <li><a class="flat-box" href="/categories/JavaScript/Algorithm/"><div class='name'>Algorithm</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/CSS/"><div class='name'>CSS</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Linux/Git/"><div class='name'>Git</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Git/"><div class='name'>Git</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/HTTP/"><div class='name'>HTTP</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/HTTP/Hapijs/"><div class='name'>Hapijs</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Java/"><div class='name'>Java</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Nodejs/JavaScript/"><div class='name'>JavaScript</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/JavaScript/"><div class='name'>JavaScript</div><div class='badget'>6</div></a></li>
    
        <li><a class="flat-box" href="/categories/Vue/JavaScript/"><div class='name'>JavaScript</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Linux/"><div class='name'>Linux</div><div class='badget'>3</div></a></li>
    
        <li><a class="flat-box" href="/categories/Nodejs/"><div class='name'>Nodejs</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/React/"><div class='name'>React</div><div class='badget'>3</div></a></li>
    
        <li><a class="flat-box" href="/categories/React/React-Router/"><div class='name'>React-Router</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/JavaScript/Redux/"><div class='name'>Redux</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/React/TypeScript/"><div class='name'>TypeScript</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Linux/Vim/"><div class='name'>Vim</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Vue/"><div class='name'>Vue</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Webpack/Vue/"><div class='name'>Vue</div><div class='badget'>2</div></a></li>
    
        <li><a class="flat-box" href="/categories/Web-性能优化/"><div class='name'>Web 性能优化</div><div class='badget'>1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Webpack/"><div class='name'>Webpack</div><div class='badget'>2</div></a></li>
    
        <li><a class="flat-box" href="/categories/Git/译文/"><div class='name'>译文</div><div class='badget'>1</div></a></li>
    
    </ul>
    
</div>
</section>

  


      </aside>
      <script>setLoadingBarProgress(60);</script>
    </div>
  </div>
  <footer id="footer" class="clearfix">

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/zhongdeming428" class="social github"
          target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="https://twitter.com/zhongdeming428" class="social twitter"
          target="_blank" rel="external">
          <span class="icon icon-twitter"></span>
        </a>
      
        <a href="/atom.xml" class="social rss"
          target="_blank" rel="external">
          <span class="icon icon-rss"></span>
        </a>
      
    
  </div>
  
  <div>Theme <a href='https://github.com/stkevintan/hexo-theme-material-flow' class="codename">MaterialFlow</a> designed by <a href="http://keyin.me/" target="_blank">Kevin Tan</a>.</div>
  
</footer>


  <script>setLoadingBarProgress(80);</script>
  

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src='//cdn.bootcss.com/node-waves/0.7.5/waves.min.js'></script>
<script src="//cdn.bootcss.com/scrollReveal.js/3.3.2/scrollreveal.min.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<script src="/js/jquery.fitvids.js"></script>
<script>
	var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
	var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
	var ALGOLIA_API_KEY = "";
	var ALGOLIA_APP_ID = "";
	var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "hexo";
  var ROOT = "/"||"/";
  if(!ROOT.endsWith('/'))ROOT += '/';
</script>
<script src="/js/search.js"></script>
<script src="/js/app.js"></script>


  <script>setLoadingBarProgress(100);</script>
  <script>
    !function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var n=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=1;t.default=function(){return""+n++},e.exports=t.default});e(n);var o=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,n=null;return function(){for(var o=this,i=arguments.length,r=Array(i),a=0;a<i;a++)r[a]=arguments[a];clearTimeout(n),n=setTimeout(function(){e.apply(o,r)},t)}},e.exports=t.default});e(o);var i=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.SizeSensorId="size-sensor-id",t.SensorStyle="display:block;position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden;pointer-events:none;z-index:-1;opacity:0",t.SensorClassName="size-sensor-object"});e(i);i.SizeSensorId,i.SensorStyle,i.SensorClassName;var r=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createSensor=void 0;var n,r=(n=o)&&n.__esModule?n:{default:n};t.createSensor=function(e){var t=void 0,n=[],o=(0,r.default)(function(){n.forEach(function(t){t(e)})}),a=function(){t&&t.parentNode&&(t.contentDocument.defaultView.removeEventListener("resize",o),t.parentNode.removeChild(t),t=void 0,n=[])};return{element:e,bind:function(r){t||(t=function(){"static"===getComputedStyle(e).position&&(e.style.position="relative");var t=document.createElement("object");return t.onload=function(){t.contentDocument.defaultView.addEventListener("resize",o),o()},t.setAttribute("style",i.SensorStyle),t.setAttribute("class",i.SensorClassName),t.type="text/html",e.appendChild(t),t.data="about:blank",t}()),-1===n.indexOf(r)&&n.push(r)},destroy:a,unbind:function(e){var o=n.indexOf(e);-1!==o&&n.splice(o,1),0===n.length&&t&&a()}}}});e(r);r.createSensor;var a=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createSensor=void 0;var n,i=(n=o)&&n.__esModule?n:{default:n};t.createSensor=function(e){var t=void 0,n=[],o=(0,i.default)(function(){n.forEach(function(t){t(e)})}),r=function(){t.disconnect(),n=[],t=void 0};return{element:e,bind:function(i){t||(t=function(){var t=new ResizeObserver(o);return t.observe(e),o(),t}()),-1===n.indexOf(i)&&n.push(i)},destroy:r,unbind:function(e){var o=n.indexOf(e);-1!==o&&n.splice(o,1),0===n.length&&t&&r()}}}});e(a);a.createSensor;var s=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createSensor=void 0;t.createSensor="undefined"!=typeof ResizeObserver?a.createSensor:r.createSensor});e(s);s.createSensor;var u=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.removeSensor=t.getSensor=void 0;var o,r=(o=n)&&o.__esModule?o:{default:o};var a={};t.getSensor=function(e){var t=e.getAttribute(i.SizeSensorId);if(t&&a[t])return a[t];var n=(0,r.default)();e.setAttribute(i.SizeSensorId,n);var o=(0,s.createSensor)(e);return a[n]=o,o},t.removeSensor=function(e){var t=e.element.getAttribute(i.SizeSensorId);e.element.removeAttribute(i.SizeSensorId),e.destroy(),t&&a[t]&&delete a[t]}});e(u);u.removeSensor,u.getSensor;var c=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.clear=t.bind=void 0;t.bind=function(e,t){var n=(0,u.getSensor)(e);return n.bind(t),function(){n.unbind(t)}},t.clear=function(e){var t=(0,u.getSensor)(e);(0,u.removeSensor)(t)}});e(c);var l=c.clear,d=c.bind,v=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},f=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame||window.clearTimeout,m=function(e){return new Array(e).fill(0).map(function(e,t){return t})},h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},y=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var p,w;new(function(){function e(t,n){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.randomPoints=function(){return m(o.c.count).map(function(){return{x:Math.random()*o.canvas.width,y:Math.random()*o.canvas.height,xa:2*Math.random()-1,ya:2*Math.random()-1,max:6e3}})},this.el=t,this.c=h({zIndex:-1,opacity:.5,color:"0,0,0",count:99},n),this.canvas=this.newCanvas(),this.context=this.canvas.getContext("2d"),this.points=this.randomPoints(),this.current={x:null,y:null,max:2e4},this.all=this.points.concat([this.current]),this.bindEvent(),this.requestFrame(this.drawCanvas)}return y(e,[{key:"bindEvent",value:function(){var e=this;d(this.el,function(){e.canvas.width=e.el.clientWidth,e.canvas.height=e.el.clientHeight}),this.onmousemove=window.onmousemove,window.onmousemove=function(t){e.current.x=t.clientX-e.el.offsetLeft+document.scrollingElement.scrollLeft,e.current.y=t.clientY-e.el.offsetTop+document.scrollingElement.scrollTop,e.onmousemove&&e.onmousemove(t)},this.onmouseout=window.onmouseout,window.onmouseout=function(){e.current.x=null,e.current.y=null,e.onmouseout&&e.onmouseout()}}},{key:"newCanvas",value:function(){"static"===getComputedStyle(this.el).position&&(this.el.style.position="relative");var e,t=document.createElement("canvas");return t.style.cssText="display:block;position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden;pointer-events:none;z-index:"+(e=this.c).zIndex+";opacity:"+e.opacity,t.width=this.el.clientWidth,t.height=this.el.clientHeight,this.el.appendChild(t),t}},{key:"requestFrame",value:function(e){var t=this;this.tid=v(function(){return e.call(t)})}},{key:"drawCanvas",value:function(){var e=this,t=this.context,n=this.canvas.width,o=this.canvas.height,i=this.current,r=this.points,a=this.all;t.clearRect(0,0,n,o);var s=void 0,u=void 0,c=void 0,l=void 0,d=void 0,v=void 0;r.forEach(function(r,f){for(r.x+=r.xa,r.y+=r.ya,r.xa*=r.x>n||r.x<0?-1:1,r.ya*=r.y>o||r.y<0?-1:1,t.fillRect(r.x-.5,r.y-.5,1,1),u=f+1;u<a.length;u++)null!==(s=a[u]).x&&null!==s.y&&(l=r.x-s.x,d=r.y-s.y,(v=l*l+d*d)<s.max&&(s===i&&v>=s.max/2&&(r.x-=.03*l,r.y-=.03*d),c=(s.max-v)/s.max,t.beginPath(),t.lineWidth=c/2,t.strokeStyle="rgba("+e.c.color+","+(c+.2)+")",t.moveTo(r.x,r.y),t.lineTo(s.x,s.y),t.stroke()))}),this.requestFrame(this.drawCanvas)}},{key:"destroy",value:function(){l(this.el),window.onmousemove=this.onmousemove,window.onmouseout=this.onmouseout,f(this.tid),this.canvas.parentNode.removeChild(this.canvas)}}]),e}())(document.body,(p=document.getElementsByTagName("script"),{zIndex:(w=p[p.length-1]).getAttribute("zIndex"),opacity:w.getAttribute("opacity"),color:w.getAttribute("color"),count:Number(w.getAttribute("count"))||99}))}();
  </script>
</body>
</html>
